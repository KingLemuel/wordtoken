<link rel="stylesheet" type="text/css" href="/user_profile.css">


<div class="cont main">
  <div class="profile_bg">
    <!-- Handicon image -->
    <% if current_user == @user  %>
      <div class="handshake_btn">

          <img class='handshake_icon' src="data:image/png;base64,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"/>

      <p>Handshakes</p>

      </div>
    <% end %>


    <div class="profile_pic"><%= gravatar_for @user, 190 %></div>
  </div>
  <div class="about">
    <div class="stats">
      <div class="credibility">
        <div class="num">2949</div>
        <div class="title">Credibility</div>
      </div>
      <div class="handshakes">
      <% handshakes = @user.handshakes.count + @user.inverse_handshakes.count %>
        <div class="num"><%= handshakes %></div>
        <div class="title"><%= handshakes == 1 ? "Handshake": "Handshakes" %></div>
      </div>
      <div class="divider"></div>
      <div class="all_tokens">
        <div class="num"><%= @user.tokens_received.count%></div>
        <div class="title">Tokens</div>
      </div>
      <div class="last_active">
        <div class="num">3m</div>
        <div class="title">Last Seen</div>
      </div>
    </div>
    <div class="name_sect">
      <div class="name">
        <div class="line"></div>
        <div class="text"><%= @user.name %></div>
      </div>
    </div>



    <div class="two_columns">
      <div class="left">
      <% token_data = @user.passive_connections.group_by { |e| e.word_token.label }.sort_by {|k,v| v.size}.reverse %>

        <h3>Tokens</h3>
        <div class="no_token_msg hide">Welcome, you WordTokens will show up here. Get your friends to connect with you.</div>
        <div class="tokens">
        <% token_data.each do |e| %> 
          <div class="token">
            <div class="tag">
              <div class="word"><%= e.first %></div>
              <span class="times">x</span>
              <span class="num"><%= e[1].count %></span>
            </div>

            <div class="people">
           <% e[1].each do |e| %>
              <div class="person"><%= link_to gravatar_for(e.giver, 50), e.giver %></div>
          <% end %>
            </div>
          </div>
        <% end %>
        </div>






        <div class="show_more">
          Show More
        </div>
      </div>
      <div class="right">


        <div class="buttons">
          <%= render 'request_form' %>
        </div>

        <div class="notable">
          <div class="title">Notable Givers</div>
   
          <div class="person">
            <div class="img"></div>
            <div class="info"> 
              <span class="name">Wayne</span>
              <span class="credibility">9999</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>


<div class="to_top">
  <div class="line"></div>
  <div class="box">Go to Top</div>
</div>


<div class="token_box">
  <div class="dialog">
    <div class="title">
      Give <span><%= @user.name %></span> A Token
    </div>
    <div class="box">
      <%= render 'transfer_token_form' %>
    </div>
  </div>
</div>

<div class="notification_box">
  <div class="dialog">
<% current_user.inverse_requests.each do |req| %>

  <% @req = req %>
    <div class="user"> 
      <div class="img"><%= link_to (gravatar_for @req.user, 35 ), @req.user %></div>
      <div class="name"><%= link_to req.user.name, @req.user %></div>
      
      <div class="btns">

        <div class="accept"><%= render 'accept_form' %></div>
        <div class="decline"><%= render 'decline_form' %></div>

      </div>
    </div>
<% end %>
  </div>
</div>

<script src="/user_profile.js"></script>


